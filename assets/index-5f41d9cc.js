import{r as i,C as F,A as y,u as w,a as x,j as e,as as P,I as k,b as D,M as T,S as O,O as R,F as B,at as M,T as W,au as q}from"./index-5c44cf89.js";import{S as N,L as V,f as $}from"./Search-7b655563.js";import{A as U}from"./ActionDelete-f7563e5d.js";import{E as G}from"./EyeOutlined-82726049.js";import{D as H}from"./DeleteOutlined-75a90ccf.js";import{P as J}from"./PlusOutlined-5a5bb3ba.js";import"./visuallyHidden-14c3de6e.js";import"./Select-292d2541.js";import"./OutlinedInput-acc43fe5.js";import"./FormControl-de68b7ca.js";import"./InputAdornment-6fc71513.js";import"./LoadingButton-35a5f9c8.js";const K=({idCompetencia:o,nombreCompetencia:r,onFinish:t,urlDelete:m,actionDelete:h,dataDelete:f})=>{const{openAlert:l}=i.useContext(F),{token:b}=i.useContext(y),{data:c,isLoading:C,hasError:S,postAWS:_}=w(),d=()=>{l("Por favor confirma que deseas eliminar la competencia: "+r,"warning",e(U,{callback:u}))},u=async()=>{const n=await _(m,h,f,b);n.success?l(n.message,"success"):l(`${n.message}: ${n.error}`,"error"),t()};return x("div",{style:{display:"flex",justifyContent:"flex-end"},children:[e(P,{title:"Ver más detalles",children:e(k,{"aria-label":"delete",color:"primary",component:D,to:o,children:e(G,{})})}),e(P,{title:"Eliminar competencia",children:e(k,{"aria-label":"delete",color:"error",onClick:d,children:e(H,{})})})]})};function Q(o,r,t,m,h){return{name:r,role:t,creationDate:$(m),actions:e(K,{idCompetencia:o,nombreCompetencia:r,onFinish:h,urlDelete:"https://aivx2bpza7.execute-api.us-east-1.amazonaws.com/prod/assessments",actionDelete:"delete_skill",dataDelete:{id:o}})}}const X=[{id:"name",numeric:!1,disablePadding:!0,label:"Nombre de la competencia",sortable:!0,align:"left"},{id:"role",numeric:!1,disablePadding:!1,label:"Rol",sortable:!0,align:"right"},{id:"creationDate",numeric:!1,disablePadding:!1,label:"Fecha de creación",sortable:!0,align:"right"},{id:"actions",numeric:!1,disablePadding:!1,label:"Acciones",sortable:!1,align:"right"}],de=()=>{const{token:o,userData:r}=i.useContext(y),{data:t,isLoading:m,hasError:h,postAWS:f}=w(),[l,b]=i.useState([]),[c,C]=i.useState(""),[S,_]=i.useState("No se han encontrado registros"),[d,u]=i.useState(1),[n,E]=i.useState(5),[v,A]=i.useState(0),L=(s,a)=>{u(a+1),p(a+1)},I=s=>{const a=parseInt(s.target.value,10);E(a),u(1),p(1,a)},p=async(s=null,a)=>{if(c.trim().length!==""){await z(c,s||d,a||n);return}await f("https://aivx2bpza7.execute-api.us-east-1.amazonaws.com/prod/assessments","get_all_skills",{id_usuario_administrador:r.id,cantidad_por_pagina:a||n,pagina:s||d},o)},z=async(s,a=null,g)=>{await f("https://aivx2bpza7.execute-api.us-east-1.amazonaws.com/prod/assessments","search_by_name_skills",{id_usuario_administrador:r.id,nombre_buscado:s,cantidad_por_pagina:g||n,pagina:a||d},o)};return i.useEffect(()=>{c.trim().length>0?(u(1),p(1,n)):p()},[c]),i.useEffect(()=>{if(t)if(t.success){if(t.data&&t.data.competencias){const s=t.data.competencias;if(s.length>0){let a=[];s.forEach(g=>{const j=Q(g.id,g.nombre,"Creador",g.fecha_de_registro,p);a=[...a,j]}),b(a),A(t.data.elementos_totales)}else b([]),_(t.message)}}else t.message&&_(t.message)},[t]),e(T,{title:"Competencias",secondary:x(O,{direction:"row",spacing:2,children:[e(N,{searchString:c,setSearchString:C}),e(R,{variant:"outlined",startIcon:e(J,{}),component:D,to:"nuevo",children:"Crear competencia"})]}),children:m?x(B,{children:[e(M,{}),e(W,{sx:{width:"100%",textAlign:"left",fontWeight:"medium"},children:"Cargando..."})]}):l.length>0?e(V,{rows:l,headCells:X,controllerPage:d,controllerRowsPerPage:n,changePage:L,changeRowsPerPage:I,totalElements:v}):e(q,{severity:"info",children:S})})};export{de as default};
