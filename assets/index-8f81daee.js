import{i as Pe,h as Ie,s as ce,l as T,r as i,m as ke,n as Se,j as e,o as ze,q as Oe,Z as We,a as C,t as Kt,k as $e,ad as Zt,aG as Jt,a8 as Yt,w as Xt,P as ea,d as Be,_ as ve,aH as ta,A as J,C as Y,u as B,S as O,aD as xe,aa as Me,M as se,T as D,aC as we,a2 as Te,aI as De,aJ as aa,aK as na,aL as ra,aM as oa,aN as sa,aO as ia,G as y,aE as Ue,O as la,p as he,F as Ne,at as ua,au as Ee}from"./index-5c44cf89.js";import{I as W,F as Ve,c as Ge,a as de,d as ye,b as G,f as da}from"./formik.esm-659644ab.js";import{u as ca,f as ma,O as H,c as He}from"./OutlinedInput-acc43fe5.js";import{L as ie}from"./LoadingButton-35a5f9c8.js";import{R as ga,a as pa}from"./index-4bf1bdbf.js";import{T as fa}from"./TextField-c4afaff6.js";import{M as je,S as ha}from"./Select-292d2541.js";import{S as va,M as wa,F as xa}from"./MinusOutlined-c729137c.js";import{S as Qe}from"./SaveOutlined-e7d4d93f.js";import{F as _a}from"./FormControl-de68b7ca.js";function ba(t){return Pe("MuiFormGroup",t)}Ie("MuiFormGroup",["root","row","error"]);const ya=["className","row"],Sa=t=>{const{classes:a,row:s,error:r}=t;return Oe({root:["root",s&&"row",r&&"error"]},ba,a)},Ca=ce("div",{name:"MuiFormGroup",slot:"Root",overridesResolver:(t,a)=>{const{ownerState:s}=t;return[a.root,s.row&&a.row]}})(({ownerState:t})=>T({display:"flex",flexDirection:"column",flexWrap:"wrap"},t.row&&{flexDirection:"row"})),Ea=i.forwardRef(function(a,s){const r=ke({props:a,name:"MuiFormGroup"}),{className:f,row:d=!1}=r,b=Se(r,ya),n=ca(),h=ma({props:r,muiFormControl:n,states:["error"]}),l=T({},r,{row:d,error:h.error}),c=Sa(l);return e(Ca,T({className:ze(c.root,f),ownerState:l,ref:s},b))}),Fa=Ea,Aa=We(e("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),"RadioButtonUnchecked"),La=We(e("path",{d:"M8.465 8.465C9.37 7.56 10.62 7 12 7C14.76 7 17 9.24 17 12C17 13.38 16.44 14.63 15.535 15.535C14.63 16.44 13.38 17 12 17C9.24 17 7 14.76 7 12C7 10.62 7.56 9.37 8.465 8.465Z"}),"RadioButtonChecked"),qa=ce("span")({position:"relative",display:"flex"}),Ra=ce(Aa)({transform:"scale(1)"}),Pa=ce(La)(({theme:t,ownerState:a})=>T({left:0,position:"absolute",transform:"scale(0)",transition:t.transitions.create("transform",{easing:t.transitions.easing.easeIn,duration:t.transitions.duration.shortest})},a.checked&&{transform:"scale(1)",transition:t.transitions.create("transform",{easing:t.transitions.easing.easeOut,duration:t.transitions.duration.shortest})}));function Ke(t){const{checked:a=!1,classes:s={},fontSize:r}=t,f=T({},t,{checked:a});return C(qa,{className:s.root,ownerState:f,children:[e(Ra,{fontSize:r,className:s.background,ownerState:f}),e(Pa,{fontSize:r,className:s.dot,ownerState:f})]})}const Ia=i.createContext(void 0),Ze=Ia;function ka(){return i.useContext(Ze)}function za(t){return Pe("MuiRadio",t)}const Oa=Ie("MuiRadio",["root","checked","disabled","colorPrimary","colorSecondary"]),Fe=Oa,Wa=["checked","checkedIcon","color","icon","name","onChange","size","className"],$a=t=>{const{classes:a,color:s}=t,r={root:["root",`color${$e(s)}`]};return T({},a,Oe(r,za,a))},Ba=ce(va,{shouldForwardProp:t=>Kt(t)||t==="classes",name:"MuiRadio",slot:"Root",overridesResolver:(t,a)=>{const{ownerState:s}=t;return[a.root,a[`color${$e(s.color)}`]]}})(({theme:t,ownerState:a})=>T({color:(t.vars||t).palette.text.secondary},!a.disableRipple&&{"&:hover":{backgroundColor:t.vars?`rgba(${a.color==="default"?t.vars.palette.action.activeChannel:t.vars.palette[a.color].mainChannel} / ${t.vars.palette.action.hoverOpacity})`:Zt(a.color==="default"?t.palette.action.active:t.palette[a.color].main,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},a.color!=="default"&&{[`&.${Fe.checked}`]:{color:(t.vars||t).palette[a.color].main}},{[`&.${Fe.disabled}`]:{color:(t.vars||t).palette.action.disabled}}));function Ma(t,a){return typeof a=="object"&&a!==null?t===a:String(t)===String(a)}const Ae=e(Ke,{checked:!0}),Le=e(Ke,{}),Ta=i.forwardRef(function(a,s){var r,f;const d=ke({props:a,name:"MuiRadio"}),{checked:b,checkedIcon:n=Ae,color:h="primary",icon:l=Le,name:c,onChange:w,size:u="medium",className:m}=d,g=Se(d,Wa),x=T({},d,{color:h,size:u}),S=$a(x),L=ka();let A=b;const I=Jt(w,L&&L.onChange);let F=c;return L&&(typeof A>"u"&&(A=Ma(L.value,d.value)),typeof F>"u"&&(F=L.name)),e(Ba,T({type:"radio",icon:i.cloneElement(l,{fontSize:(r=Le.props.fontSize)!=null?r:u}),checkedIcon:i.cloneElement(n,{fontSize:(f=Ae.props.fontSize)!=null?f:u}),ownerState:x,classes:S,name:F,checked:A,onChange:I,ref:s,className:ze(S.root,m)},g))}),Da=Ta,Ua=["actions","children","defaultValue","name","onChange","value"],Na=i.forwardRef(function(a,s){const{actions:r,children:f,defaultValue:d,name:b,onChange:n,value:h}=a,l=Se(a,Ua),c=i.useRef(null),[w,u]=Yt({controlled:h,default:d,name:"RadioGroup"});i.useImperativeHandle(r,()=>({focus:()=>{let S=c.current.querySelector("input:not(:disabled):checked");S||(S=c.current.querySelector("input:not(:disabled)")),S&&S.focus()}}),[]);const m=Xt(s,c),g=ea(b),x=i.useMemo(()=>({name:g,onChange(S){u(S.target.value),n&&n(S,S.target.value)},value:w}),[g,n,u,w]);return e(Ze.Provider,{value:x,children:e(Fa,T({role:"radiogroup",ref:m},l,{children:f}))})}),Va=Na;var Ga={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M696 480H544V328c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v152H328c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h152v152c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V544h152c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"plus-circle",theme:"outlined"};const Ha=Ga;var Je=function(a,s){return i.createElement(Be,ve(ve({},a),{},{ref:s,icon:Ha}))};Je.displayName="PlusCircleOutlined";const Ye=i.forwardRef(Je);var ja={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M625.9 115c-5.9 0-11.9 1.6-17.4 5.3L254 352H90c-8.8 0-16 7.2-16 16v288c0 8.8 7.2 16 16 16h164l354.5 231.7c5.5 3.6 11.6 5.3 17.4 5.3 16.7 0 32.1-13.3 32.1-32.1V147.1c0-18.8-15.4-32.1-32.1-32.1zM586 803L293.4 611.7l-18-11.7H146V424h129.4l17.9-11.7L586 221v582zm348-327H806c-8.8 0-16 7.2-16 16v40c0 8.8 7.2 16 16 16h128c8.8 0 16-7.2 16-16v-40c0-8.8-7.2-16-16-16zm-41.9 261.8l-110.3-63.7a15.9 15.9 0 00-21.7 5.9l-19.9 34.5c-4.4 7.6-1.8 17.4 5.8 21.8L856.3 800a15.9 15.9 0 0021.7-5.9l19.9-34.5c4.4-7.6 1.7-17.4-5.8-21.8zM760 344a15.9 15.9 0 0021.7 5.9L892 286.2c7.6-4.4 10.2-14.2 5.8-21.8L878 230a15.9 15.9 0 00-21.7-5.9L746 287.8a15.99 15.99 0 00-5.8 21.8L760 344z"}}]},name:"sound",theme:"outlined"};const Qa=ja;var Xe=function(a,s){return i.createElement(Be,ve(ve({},a),{},{ref:s,icon:Qa}))};Xe.displayName="SoundOutlined";const Ka=i.forwardRef(Xe),Za=()=>{const[t,a]=i.useState({data:null,isLoading:!1,hasError:null}),s=async(r,f,d)=>{a({...t,isLoading:!0});const b={"Content-Type":f};let n=null,h=null;try{n=await ta.put(r,d,{headers:b})}catch(l){console.error(l),h="Error al procesar la solicitud: "+l}return a({data:n,isLoading:!1,hasError:h}),n};return{data:t.data,isLoading:t.isLoading,hasError:t.hasError,postUpload:s}},Ja=({isLoadingData:t,question:a,savedAnswer:s="",setFieldValue:r})=>{const{token:f}=i.useContext(J),{openAlert:d}=i.useContext(Y),{data:b,isLoading:n,hasError:h,postAWS:l}=B(),[c,w]=i.useState(s),u=g=>{w(g.target.value)},m=async()=>{const g=await l("https://aivx2bpza7.execute-api.us-east-1.amazonaws.com/prod/assessments","generate_ai_answer",{pregunta:a},f);if(!g){d("Lo sentimos, ha ocurrido un error al intentar obtener una respuesta dad por inteligencia artificial","error");return}if(!g.success){d(`${g.message}: ${g.error}`,"error");return}const x=g.data;w(x.respuesta)};return i.useEffect(()=>{r("suggestedanswer",c)},[c]),C(O,{spacing:1,children:[e(W,{htmlFor:"suggestedanswer-form",children:"Respuesta sugerida"}),e(H,{fullWidth:!0,multiline:!0,maxRows:3,minRows:2,id:"suggestedanswer-form",value:c,name:"suggestedanswer",onChange:u,placeholder:"..."}),e("div",{style:{alignSelf:"flex-end"},children:e(ie,{disabled:t||n,size:"medium",variant:"outlined",color:"primary",onClick:m,loading:n,loadingPosition:"start",startIcon:e(ga,{}),children:"Generar respuesta con IA"})})]})},Ya=({id:t,word:a,color:s,onDelete:r,type:f="palabras_clave"})=>{const{data:d,isLoading:b,hasError:n,postAWS:h}=B(),{token:l}=i.useContext(J),{openAlert:c}=i.useContext(Y);return xe(),e(Me,{variant:"outlined",color:s||"primary",label:a,onDelete:async()=>{const u=f=="palabras_clave"?"id_palabra_clave":"id_descarrilador",m=await h("https://aivx2bpza7.execute-api.us-east-1.amazonaws.com/prod/assessments",f=="palabras_clave"?"delete_keyword":"delete_derailer",{[u]:t},l);if(!m){c("Lo sentimos, ha ocurrido un error al eliminar la palabra","error");return}if(!m.success){c(`${m.message}: ${m.error}`,"error");return}r()},sx:{m:.5},disabled:b})};function qe({onChangeWords:t,color:a,label:s,type:r="palabras_clave"}){const{data:f,isLoading:d,hasError:b,postAWS:n}=B(),{data:h,isLoading:l,hasError:c,postAWS:w}=B(),{token:u}=i.useContext(J),{openAlert:m}=i.useContext(Y),{pregunta_id:g}=xe(),[x,S]=i.useState(""),[L,A]=i.useState(null),I=_=>{S(_.target.value)},F=async()=>{const _=await n("https://aivx2bpza7.execute-api.us-east-1.amazonaws.com/prod/assessments",r=="palabras_clave"?"get_all_question_keywords":"get_all_question_derailers",{id_pregunta:g},u);if(!_){A([]);return}if(!_.success){m(`${_.message}: ${_.error}`,"error"),A([]);return}const v=_.data[r];A(v||[])},P=async()=>{if(x.trim().length===0)return;const _=r=="palabras_clave"?"palabra":"descarrilador",v=await w("https://aivx2bpza7.execute-api.us-east-1.amazonaws.com/prod/assessments",r=="palabras_clave"?"add_keyword":"add_derailer",{[_]:x,id_pregunta:g},u);if(!v){m("Lo sentimos, ha ocurrido un error al agregar la palabra","error");return}if(!v.success){m(`${v.message}: ${v.error}`,"error");return}v.data,F(),S("")};return i.useEffect(()=>{t&&t(L)},[L]),i.useEffect(()=>{F()},[]),C(O,{spacing:1,flexWrap:"nowrap",children:[e(W,{htmlFor:"keywords-form",children:s}),C(se,{children:[e(O,{direction:"row",spacing:0,flexWrap:"wrap",children:L?L.length>0?L.map((_,v)=>e(Ya,{color:a||"primary",id:_.id,word:_[r=="palabras_clave"?"palabra":"descarrilador"],onDelete:F,type:r},v)):e(D,{variant:"body1",color:"secondary",children:"Aún no se han agregado palabras..."}):e(D,{variant:"body1",color:"secondary",children:"Cargando..."})}),e(we,{sx:{my:2}}),C(Te,{sx:{display:"flex",alignItems:"center",width:"100%",boxShadow:"none",border:"1px solid",borderColor:"primary.main"},children:[e(He,{value:x,onChange:I,sx:{ml:2,flex:1},placeholder:"Agrega una palabra",inputProps:{"aria-label":"agrega una palabra"}}),e(we,{sx:{height:28,m:.5},orientation:"vertical"}),e(ie,{size:"large",startIcon:e(Ye,{}),loadingPosition:"start",onClick:P,loading:l||d,disabled:l||d||x.trim().length===0,variant:"text",children:"Agregar"})]})]})]})}var et={},_e={},Xa=aa,en=na,tn=De,an=tn("match"),nn=function(t){var a;return Xa(t)&&((a=t[an])!==void 0?!!a:en(t)=="RegExp")},rn=nn,on=TypeError,sn=function(t){if(rn(t))throw on("The method doesn't accept regular expressions");return t},ln=De,un=ln("match"),dn=function(t){var a=/./;try{"/./"[t](a)}catch{try{return a[un]=!1,"/./"[t](a)}catch{}}return!1},cn=ra,mn=oa,gn=sn,pn=sa,Re=ia,fn=dn,hn=mn("".indexOf);cn({target:"String",proto:!0,forced:!fn("includes")},{includes:function(a){return!!~hn(Re(pn(this)),Re(gn(a)),arguments.length>1?arguments[1]:void 0)}});Object.defineProperty(_e,"__esModule",{value:!0});_e.default=void 0;var p=vn(i);function tt(t){if(typeof WeakMap!="function")return null;var a=new WeakMap,s=new WeakMap;return(tt=function(f){return f?s:a})(t)}function vn(t,a){if(!a&&t&&t.__esModule)return t;if(t===null||typeof t!="object"&&typeof t!="function")return{default:t};var s=tt(a);if(s&&s.has(t))return s.get(t);var r={},f=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var d in t)if(d!=="default"&&Object.prototype.hasOwnProperty.call(t,d)){var b=f?Object.getOwnPropertyDescriptor(t,d):null;b&&(b.get||b.set)?Object.defineProperty(r,d,b):r[d]=t[d]}return r.default=t,s&&s.set(t,r),r}const wn=t=>{let{vh_playPause:a,vh_audioEnded:s,vh_audioStarted:r,vh_talkEnded:f,vh_talkStarted:d,vh_scenePreloaded:b,vh_sceneLoaded:n,vh_portalReady:h,vh_audioProgress:l,vh_ttsLoaded:c,vh_audioLoaded:w,vh_aiResponse:u,selectPortal:m,unloadScene:g,loadSceneByID:x,preloadScene:S,preloadNextScene:L,gotoScene:A,gotoPrevScene:I,gotoNextScene:F,overlayClose:P,overlayOpen:_,is3D:v,dynamicResize:k,setStatus:U,setColor:X,setBackgroundColor:ee,setBackground:j,getSceneAttributes:te,replay:q,stopSpeech:R,setPlayerVolume:z,saySilent:Q,sayAIResponse:M,loadText:N,loadAudio:me,sayAudio:le,embed:nt,sayText:V,freezeToggle:ae,recenter:ne,setFacialExpression:K,clearExpressionList:re,setIdleMovement:ue,setSpeechMovement:ge,setBlinking:pe}=t;(0,p.useEffect)(()=>{function o(){var oe=document.createElement("script");oe.type="text/javascript",oe.src="//vhss-d.oddcast.com/vhost_embed_functions_v4.php?acc=5626448&js=1",oe.onload=function(){console.log("first")},console.log("third"),document.head.appendChild(oe)}function E(){var oe=setInterval(()=>{if(typeof AC_VHost_Embed=="function"){clearInterval(oe);var be=document.createElement("script");be.type="text/javascript",be.innerHTML="AC_VHost_Embed(".concat(nt,")"),document.getElementById("sp_embed").appendChild(be)}},10)}const $=document.head.getElementsByTagName("script");if($.length>0){console.log("out",$);for(var Z=!1,fe=0;fe<$.length;fe++)$[fe].src.includes("vhost_embed_functions_v4.php")&&(Z=!0,console.log("second"),E()),$.length===fe+1&&!Z&&o()}else o()},[]),(0,p.useEffect)(()=>{le!=null&&(console.log("button clicked",typeof le),console.log(le),rt(le[0]))},[le]);function rt(o){window.sayAudio(o)}(0,p.useEffect)(()=>{console.log(V),V!=null&&(console.log("button clicked",typeof V),console.log(V),ot(V[0],V[1],V[2],V[3]))},[V]);function ot(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",$=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"",Z=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"";console.log(o,E,$,Z),window.sayText(o,E,$,Z)}(0,p.useEffect)(()=>{console.log(ae),ae!=null&&(console.log("button clicked",typeof ae),console.log(ae),st(ae[0]))},[ae]);function st(){window.freezeToggle()}(0,p.useEffect)(()=>{console.log(ne),ne!=null&&(console.log("button clicked",typeof ne),console.log(ne),it(ne[0]))},[ne]);function it(){window.recenter()}(0,p.useEffect)(()=>{console.log(K),K!=null&&(console.log(K),lt(K[0],K[1],K[2]))},[K]);function lt(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",$=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";window.setFacialExpression(o,E,$)}(0,p.useEffect)(()=>{console.log(re),re!=null&&(console.log("button clicked",typeof re),console.log(re),ut(re[0]))},[re]);function ut(){window.clearExpressionList()}(0,p.useEffect)(()=>{console.log(ue),ue!=null&&dt(ue[0],ue[1])},[ue]);function dt(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";window.setIdleMovement(o,E)}(0,p.useEffect)(()=>{console.log(ge),ge!=null&&ct(ge[0])},[ge]);function ct(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";window.setSpeechMovement(o)}(0,p.useEffect)(()=>{console.log(pe),pe!=null&&mt(pe[0])},[pe]);function mt(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";window.setBlinking(o)}(0,p.useEffect)(()=>{console.log(me),me!=null&&gt(me[0])},[me]);function gt(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";window.loadAudio(o)}(0,p.useEffect)(()=>{console.log(N),N!=null&&pt(N[0],N[1],N[2],N[3],N[4],N[5])},[N]);function pt(){window.loadText(expression,amplitude,duration)}(0,p.useEffect)(()=>{console.log(M),M!=null&&ft(M[0],M[1],M[2],M[3],M[4],M[5],M[6])},[M]);function ft(){window.sayAIResponse(expression,amplitude,duration)}(0,p.useEffect)(()=>{console.log(Q),Q!=null&&ht(Q[0])},[Q]);function ht(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";window.saySilent(o)}(0,p.useEffect)(()=>{console.log(z),z!=null&&vt(z[0])},[z]);function vt(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";window.setPlayerVolume(o)}(0,p.useEffect)(()=>{console.log(R),R!=null&&wt(R[0])},[R]);function wt(){window.stopSpeech()}(0,p.useEffect)(()=>{console.log(q),q!=null&&xt(q[0])},[q]);function xt(){window.replay()}(0,p.useEffect)(()=>{console.log(te),te!=null&&_t(te[0])},[te]);function _t(){window.getSceneAttributes()}(0,p.useEffect)(()=>{console.log(j),j!=null&&bt(j[0])},[j]);function bt(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";window.setBackground(o)}(0,p.useEffect)(()=>{console.log(ee),ee!=null&&yt(ee[0])},[ee]);function yt(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";window.setBackgroundColor(o)}(0,p.useEffect)(()=>{console.log(X),X!=null&&St(X[0])},[X]);function St(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";window.setColor(o,E)}(0,p.useEffect)(()=>{console.log(U),U!=null&&Ct(U[0],U[1],U[2],U[3])},[U]);function Ct(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",$=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"",Z=arguments.length>3?arguments[3]:void 0;window.setStatus(o,E,$,Z)}(0,p.useEffect)(()=>{console.log(k),k!=null&&Et(k[0],k[1])},[k]);function Et(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";window.dynamicResize(o,E)}(0,p.useEffect)(()=>{console.log(v),v!=null&&Ft(v[0])},[v]);function Ft(){window.is3D()}(0,p.useEffect)(()=>{console.log(_),_!=null&&At(_[0],_[1])},[_]);function At(){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";window.overlayOpen(mode,o)}(0,p.useEffect)(()=>{console.log(P),P!=null&&Lt(P[0])},[P]);function Lt(){window.overlayClose()}(0,p.useEffect)(()=>{console.log(F),F!=null&&qt(F[0])},[F]);function qt(){window.gotoNextScene()}(0,p.useEffect)(()=>{console.log(I),I!=null&&Rt(I[0])},[I]);function Rt(){window.gotoPrevScene()}(0,p.useEffect)(()=>{console.log(A),A!=null&&Pt(A[0])},[A]);function Pt(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";window.gotoScene(o)}(0,p.useEffect)(()=>{console.log(L),L!=null&&It(L[0])},[L]);function It(){window.preloadNextScene()}(0,p.useEffect)(()=>{console.log(S),S!=null&&kt(S[0])},[S]);function kt(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";window.preloadScene(o)}(0,p.useEffect)(()=>{console.log(x),x!=null&&zt(x[0],x[1])},[x]);function zt(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";window.loadSceneByID(o,E)}(0,p.useEffect)(()=>{console.log(g),g!=null&&Ot(g[0])},[g]);function Ot(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";window.unloadScene(o)}(0,p.useEffect)(()=>{console.log(m),m!=null&&Wt(m[0])},[m]);function Wt(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";window.selectPortal(o)}(0,p.useEffect)(()=>{u!=null&&$t(u[0],u[1])},[u]);function $t(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";window.vh_aiResponse(o,E)}(0,p.useEffect)(()=>{w!=null&&Bt(w[0],w[1])},[w]);function Bt(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";window.vh_audioLoaded(o,E)}(0,p.useEffect)(()=>{c!=null&&Mt(c[0],c[1])},[c]);function Mt(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";window.vh_ttsLoaded(o,E)}(0,p.useEffect)(()=>{l!=null&&Tt(l[0],l[1])},[l]);function Tt(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";window.vh_audioProgress(o,E)}(0,p.useEffect)(()=>{h!=null&&Dt(h[0])},[h]);function Dt(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";window.vh_portalReady(o)}(0,p.useEffect)(()=>{n!=null&&Ut(n[0],n[1])},[n]);function Ut(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";window.vh_sceneLoaded(o,E)}(0,p.useEffect)(()=>{b!=null&&Nt(b[0],b[1])},[b]);function Nt(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";window.vh_scenePreloaded(o,E)}(0,p.useEffect)(()=>{d!=null&&Vt(d[0])},[d]);function Vt(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";window.vh_talkStarted(o)}(0,p.useEffect)(()=>{f!=null&&Gt(f[0])},[f]);function Gt(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";window.vh_talkEnded(o)}(0,p.useEffect)(()=>{r!=null&&Ht(r[0])},[r]);function Ht(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";window.vh_audioStarted(o)}(0,p.useEffect)(()=>{s!=null&&jt(s[0])},[s]);function jt(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";window.vh_audioEnded(o)}(0,p.useEffect)(()=>{a!=null&&Qt(a[0],a[1])},[a]);function Qt(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";window.vh_playPause(o,E)}return p.default.createElement("div",{id:"sp_embed",className:"Comment"})};var xn=wn;_e.default=xn;(function(t){Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"SitePal",{enumerable:!0,get:function(){return a.default}});var a=s(_e);function s(r){return r&&r.__esModule?r:{default:r}}})(et);const _n=({textToSay:t="",avatarId:a,setAvatarId:s})=>{const{postAWS:r}=B(),{token:f}=i.useContext(J),{openAlert:d}=i.useContext(Y),[b,n]=i.useState(null),[h,l]=i.useState(null),[c,w]=i.useState(null),[u,m]=i.useState(null),[g,x]=i.useState([]),S=F=>{w(null);const P=F.target.value,_=g.find(v=>v.id===P);setTimeout(()=>{w(_),m(P),s(P)},10)},L=async()=>{var P;const F=await r("https://aivx2bpza7.execute-api.us-east-1.amazonaws.com/prod/assessments","get_avatares",{},f);if(!F){d("Lo sentimos, ha ocurrido un error al intentar obtener la lista de avatares disponibles","error");return}if(F.success){const _=(P=F.data)==null?void 0:P.avatares;if(x(_),console.log(_),a){const v=_.find(k=>k.id===a);w(v),m(a),s(a)}else w(_[0]),m(_[0].id),s(_[0].id)}else data.message&&d(`${data.message}: ${data.error}`,"error")},A=()=>{I()&&l([t,c.voz,c.lenguaje,c.motor])};i.useEffect(()=>{L()},[]);let I=()=>t&&t!=""&&t!="¿?"&&t!="?"&&t!="¿";return e(y,{item:!0,xs:12,md:12,children:e(se,{children:C(y,{container:!0,spacing:3,children:[C(y,{item:!0,xs:12,md:12,children:[e(W,{htmlFor:"skill-form",children:"Configuración de avatar"}),e(Ue,{"aria-label":"breadcrumb",children:e(D,{variant:"body2",children:"Puedes elegir un avatar para que aparezca en tu entrevista y pronuncie esta pregunta"})})]}),C(y,{item:!0,xs:12,md:12,children:[c&&e(y,{item:!0,xs:12,md:12,sx:{mb:1},children:C(O,{spacing:1,children:[e(W,{htmlFor:"skill-form",children:"Selecciona tu avatar"}),e(fa,{fullWidth:!0,id:"avatar-select",select:!0,name:"avatarSelect",value:u,onChange:S,children:g&&g.map(F=>e(je,{value:F.id,children:F.nombre},F.id))})]})}),c&&e(et.SitePal,{embed:`${c.id_cuenta_sitepal}, 500, 500,"", 1, 0, ${c.id_escena_sitepal}, 0, 1, 1, "${c.id_embed_sitepal}", 0, 1`,sayAudio:b,sayText:h}),e(ie,{disableElevation:!0,disabled:!I(),fullWidth:!0,size:"medium",variant:"outlined",color:"primary",onClick:A,loading:!1,loadingPosition:"start",startIcon:e(Ka,{}),children:"Probar"})]})]})})})},at=({videoPregunta:t,setFilevideoPregunta:a})=>{const[s,r]=i.useState(t),[f,d]=i.useState(null);return e(y,{item:!0,xs:12,md:12,children:C(se,{children:[e(W,{htmlFor:"skill-form",children:"Configuración del video propio"}),e(Ue,{"aria-label":"breadcrumb",children:e(D,{variant:"body2",children:"Puedes cargar un video de su galería para que aparezca en tu entrevista y pronuncie esta pregunta"})}),e("br",{}),C(y,{container:!0,spacing:3,children:[C(y,{item:!0,md:12,xs:12,sx:{mb:1},children:[e(y,{item:!0,xs:12,sx:{mb:1},children:e(O,{spacing:1,children:e(W,{htmlFor:"question-form",children:"Sube tu video para que los candidatos puedan escucharte"})})}),C(y,{container:!0,item:!0,xs:12,sx:{mb:1},direction:"row",spacing:1,children:[e(y,{item:!0,xs:12,sx:{mb:0},children:C(la,{fullWidth:!0,variant:"outlined",component:"label",color:"secondary",children:["Selecciona video",e("input",{hidden:!0,onChange:n=>{const h=n.target.files[0];var l=URL.createObjectURL(h);r(l),d(h),a(h)},accept:"video/mp4",type:"file"})]})}),e(y,{item:!0,xs:12,sx:{mb:0},children:e(D,{variant:"h6",color:"textSecondary",gutterBottom:!0,textAlign:"center",children:t?"Ya has configurado un video para esta pregunta":f!=null&&f.name?f==null?void 0:f.name:"Sin archivos seleccionados"})})]})]}),e(y,{item:!0,md:12,xs:12,children:s&&e(pa,{url:s,controls:!0,style:{borderRadius:".6rem",overflow:"hidden",maxHeight:"70vh"},width:"100%",height:"100%"})})]})]})})};at.propTypes={};const Ce=({questionData:t,setFilevideoPregunta:a,textToSay:s,setFieldValue:r})=>{const{postAWS:f}=B(),[d,b]=i.useState([]),[n,h]=i.useState(null),[l,c]=i.useState(null),w=async()=>{var x;const g=await f("https://aivx2bpza7.execute-api.us-east-1.amazonaws.com/prod/usuarios","get_by_name_parameters",{nombre_tipo_parametro:"tipo_avatar"},null);g.success&&b((x=g.data)==null?void 0:x.parametros)},u=g=>{if(d.length<=0)return;const x=d.find(S=>S.nombre.toLowerCase()==g.toLowerCase());return x?x.id:null},m=g=>{h(g.target.value)};return i.useEffect(()=>{r("avatartype",n)},[n]),i.useEffect(()=>{r("avatarid",l)},[l]),i.useEffect(()=>{d.length<=0||!t||(h((t==null?void 0:t.id_parametro_tipo_avatar)||u("Sin avatar")),c(t==null?void 0:t.id_avatar_virtual))},[d,t]),i.useEffect(()=>{w()},[]),C(Ne,{children:[e(y,{item:!0,xs:12,md:12,sx:{mb:2},children:C(O,{spacing:1,children:[e(W,{htmlFor:"derailers-form",children:"Tipo de avatar para la pregunta"}),e(ha,{value:n||"",onChange:m,displayEmpty:!0,inputProps:{"aria-label":"Without label"},children:d.map(g=>e(je,{value:g.id,children:g.nombre},g.id))})]})}),C(y,{item:!0,xs:12,md:12,children:[n===u("Avatar virtual")&&e(_n,{textToSay:s,setAvatarId:c,avatarId:l}),n===u("Video propio")&&e(at,{videoPregunta:t.video_avatar_pregunta,setFilevideoPregunta:a})]})]})};Ce.prototypes={questionData:he.object.isRequired,setFilevideoPregunta:he.any.isRequired,updateAvatarType:he.any.isRequired,updateAvatarId:he.any.isRequired};function bn(t){const{isLoadingSubmit:a,getIsLoading:s,questionData:r,setFilevideoPregunta:f,onSubmit:d}=t,b=async(n,{setErrors:h,setStatus:l,setSubmitting:c})=>{try{l({success:!1}),c(!1)}catch(u){console.error(u),l({success:!1}),h({submit:u.message}),c(!1)}const w={id_parametro_tipo_de_pregunta:r.id_parametro_tipo_de_pregunta,pregunta:n.question,texto_avatar:n.question,respuesta_sugerida:n.suggestedanswer,umbral_minimo_calificacion:n.qualificationthresholdmin,umbral_maximo_calificacion:n.qualificationthresholdmax,duracion_maxima_de_respuesta:n.answerduration,id_parametro_tipo_avatar:n.avatartype,id_avatar_virtual:n.avatarid,nombre_avatar:n.avatarname};d(w)};return i.useEffect(()=>{},[]),s||!r?e(D,{sx:{width:"100%",textAlign:"left",fontWeight:"medium"},children:"Cargando información de la pregunta..."}):e(Ve,{enableReinitialize:!0,initialValues:{question:r.pregunta||"",suggestedanswer:r.respuesta_sugerida||"",qualificationthresholdmin:r.umbral_minimo_califiacion||0,qualificationthresholdmax:r.umbral_maximo_calificacion||5,answerduration:r.duracion_maxima_de_respuesta||60,avatartype:null,avatarid:null,avatarname:r.nombre_avatar||"",submit:null},validationSchema:Ge().shape({question:de().max(255).required("El contenido de la pregunta es requerido"),suggestedanswer:de().max(255),qualificationthresholdmin:ye().required("El umbral de calificación es requerido").typeError("El umbral de calificación debe constar de valores numéricos"),qualificationthresholdmax:ye().required("El umbral de calificación es requerido").typeError("El umbral de calificación debe constar de valores numéricos"),answerduration:ye().required("La duración de la respuesta del usuario es requerida").typeError("La duración de la respuesta del usuario debe constar de valores numéricos"),avatarname:de().max(50,"El nombre no puede exceder los 50 caracteres")}),onSubmit:b,children:({errors:n,handleBlur:h,handleChange:l,handleSubmit:c,isSubmitting:w,touched:u,values:m,setFieldValue:g})=>e("form",{noValidate:!0,onSubmit:c,children:C(y,{container:!0,spacing:3,children:[e(y,{item:!0,xs:12,md:12,children:C(O,{spacing:1,children:[e(W,{htmlFor:"question-form",children:"Pregunta*"}),e(H,{id:"question",type:"text",value:m.question,name:"question",onBlur:h,onChange:l,placeholder:"Pregunta...",fullWidth:!0,error:Boolean(u.question&&n.question)}),u.question&&n.question&&e(G,{error:!0,id:"helper-text-question-form",children:n.question})]})}),e(y,{item:!0,xs:12,md:12,children:e(Ja,{isLoadingData:a,question:m.question,savedAnswer:m.suggestedanswer,setFieldValue:g})}),e(y,{item:!0,xs:12,md:6,children:e(qe,{color:"primary",label:"Palabras clave",type:"palabras_clave"})}),e(y,{item:!0,xs:12,md:6,children:e(qe,{color:"error",label:"Descarriladores",type:"descarriladores"})}),e(y,{item:!0,xs:12,md:6,children:C(O,{spacing:1,children:[e(W,{htmlFor:"qualificationthresholdmin",children:"Umbral de calificación"}),C(O,{spacing:3,direction:"row",alignItems:"center",children:[e(H,{fullWidth:!0,xs:4,md:4,error:Boolean(u.qualificationthresholdmin&&n.qualificationthresholddmax),id:"qualificationthresholdmin",name:"qualificationthresholdmin",value:m.qualificationthresholdmin,onBlur:h,onChange:l,placeholder:"0"}),e(wa,{}),e(H,{fullWidth:!0,xs:4,md:4,error:Boolean(u.qualificationthresholdmax&&n.qualificationthresholdmax),id:"qualificationthresholdmax",name:"qualificationthresholdmax",value:m.qualificationthresholdmax,onBlur:h,onChange:l,placeholder:"0"})]}),(u.qualificationthresholdmin||u.qualificationthresholdmax)&&(n.qualificationthresholdmin||n.qualificationthresholdmax)&&e(G,{error:!0,id:"helper-text-jobsalary",children:n.qualificationthresholdmin||n.qualificationthresholdmax})]})}),e(y,{item:!0,xs:12,md:6,children:C(O,{spacing:1,children:[e(W,{htmlFor:"answerduration-form",children:"Duración máxima de la respuesta del candidato"}),e(H,{id:"answerduration-input",type:"text",value:m.answerduration,name:"answerduration",onBlur:h,onChange:l,placeholder:"3000",fullWidth:!0,endAdornment:"segundos",error:Boolean(u.answerduration&&n.answerduration)}),u.answerduration&&n.answerduration&&e(G,{error:!0,id:"helper-text-answerduration-form",children:n.answerduration})]})}),e(y,{item:!0,xs:12,md:6,children:e(Ce,{questionData:r,setFilevideoPregunta:f,textToSay:m.question,setFieldValue:g})}),e(y,{item:!0,xs:12,md:6,children:C(O,{spacing:1,children:[e(W,{htmlFor:"avatarname-form",children:"Nombre de tu avatar"}),e(H,{id:"avatarname",type:"text",value:m.avatarname,name:"avatarname",onBlur:h,onChange:l,placeholder:"Nombre...",fullWidth:!0,error:Boolean(u.avatarname&&n.avatarname)}),u.avatarname&&n.avatarname&&e(G,{error:!0,id:"helper-text-avatarname-form",children:n.avatarname})]})}),n.submit&&e(y,{item:!0,xs:12,children:e(G,{error:!0,children:n.submit})}),e(y,{item:!0,xs:12,md:12,sx:{display:"flex",justifyContent:"flex-end"},children:e(ie,{type:"submit",disableElevation:!0,disabled:a,fullWidth:!0,size:"large",variant:"contained",color:"primary",loading:a,loadingPosition:"start",startIcon:e(Qe,{}),children:"Guardar"})})]})})})}const yn=({id:t,text:a,selected:s,onDelete:r})=>{const{data:f,isLoading:d,hasError:b,postAWS:n}=B(),{token:h}=i.useContext(J),{openAlert:l}=i.useContext(Y);return e(O,{direction:"row",spacing:2,children:e(Me,{variant:"outlined",color:s?"primary":"secondary",label:e(xa,{value:t,control:e(Da,{}),label:a}),onDelete:async()=>{const w=await n("https://aivx2bpza7.execute-api.us-east-1.amazonaws.com/prod/assessments","delete_option_pour",{id_opcion:t},h);if(!w){l("Lo sentimos, ha ocurrido un error al eliminar la opción de respuesta","error");return}if(!w.success){l(`${w.message}: ${w.error}`,"error");return}r()},sx:{m:.5},disabled:d})})};function Sn({setFieldValue:t,savedCorretAnswer:a}){const{data:s,isLoading:r,hasError:f,postAWS:d}=B(),{data:b,isLoading:n,hasError:h,postAWS:l}=B(),{token:c}=i.useContext(J),{openAlert:w}=i.useContext(Y),{pregunta_id:u}=xe(),[m,g]=i.useState(""),[x,S]=i.useState(null),[L,A]=i.useState(a),I=v=>{g(v.target.value)},F=v=>{A(v.target.value),t("correctanswer",v.target.value)},P=async()=>{const v=await d("https://aivx2bpza7.execute-api.us-east-1.amazonaws.com/prod/assessments","get_all_option_pour",{id_pregunta:u},c);if(!v){S([]);return}if(!v.success){w(`${v.message}: ${v.error}`,"error"),S([]);return}const k=v.data.opciones;S(k||[])},_=async()=>{if(S(k=>[...k,m]),g(""),m.trim().length===0)return;const v=await l("https://aivx2bpza7.execute-api.us-east-1.amazonaws.com/prod/assessments","add_option_pour",{texto:m,id_pregunta:u},c);if(!v){w("Lo sentimos, ha ocurrido un error al agregar la opción de respuesta","error");return}if(!v.success){w(`${v.message}: ${v.error}`,"error");return}v.data,P(),g("")};return i.useEffect(()=>{P()},[]),C(O,{spacing:1,flexWrap:"nowrap",children:[e(W,{htmlFor:"pour-options-form",children:"Opciones de respuesta"}),C(se,{children:[e(O,{direction:"row",spacing:0,flexWrap:"wrap",children:x?x.length>0?C(_a,{children:[e(da,{id:"options-pour-radio-buttons-group-label",sx:{mb:2},children:"Selecciona una de las opciones agregadas para marcarla como respuesta correcta para esta pregunta"}),e(Va,{"aria-labelledby":"options-pour-radio-buttons-group-label",defaultValue:"female",name:"pour-radio-buttons-group",value:L,onChange:F,children:x.map((v,k)=>e(yn,{id:v.id,text:v.texto,selected:L==v.id,onDelete:P},k))})]}):e(D,{variant:"body1",color:"secondary",children:"Aún no se han agregado opciones de respuesta..."}):e(D,{variant:"body1",color:"secondary",children:"Cargando..."})}),e(we,{sx:{my:2}}),C(Te,{sx:{display:"flex",alignItems:"center",width:"100%",boxShadow:"none",border:"1px solid",borderColor:"primary.main"},children:[e(He,{value:m,onChange:I,sx:{ml:2,flex:1},placeholder:"agrega una opción de respuesta",inputProps:{"aria-label":"agrega una opción de respuesta"}}),e(we,{sx:{height:28,m:.5},orientation:"vertical"}),e(ie,{size:"large",startIcon:e(Ye,{}),loadingPosition:"start",onClick:_,loading:n||r,disabled:n||r||m.trim().length===0,variant:"text",children:"Agregar"})]})]})]})}function Cn(t){const{isLoadingSubmit:a,getIsLoading:s,questionData:r,setFilevideoPregunta:f,onSubmit:d}=t,b=async(n,{setErrors:h,setStatus:l,setSubmitting:c})=>{try{l({success:!1}),c(!1)}catch(u){console.error(u),l({success:!1}),h({submit:u.message}),c(!1)}const w={id_parametro_tipo_de_pregunta:r.id_parametro_tipo_de_pregunta,pregunta:n.question,texto_avatar:n.question,id_parametro_tipo_avatar:n.avatartype,id_avatar_virtual:n.avatarid,nombre_avatar:n.avatarname,opcion_correcta:n.correctanswer};d(w)};return i.useEffect(()=>{},[]),s||!r?e(D,{sx:{width:"100%",textAlign:"left",fontWeight:"medium"},children:"Cargando información de la pregunta..."}):e(Ve,{enableReinitialize:!0,initialValues:{question:r.pregunta||"",avatartype:null,avatarid:null,avatarname:r.nombre_avatar||"",correctanswer:r.opcion_correcta||null,submit:null},validationSchema:Ge().shape({question:de().max(255).required("El contenido de la pregunta es requerido"),avatarname:de().max(50,"El nombre no puede exceder los 50 caracteres")}),onSubmit:b,children:({errors:n,handleBlur:h,handleChange:l,handleSubmit:c,isSubmitting:w,touched:u,values:m,setFieldValue:g})=>e("form",{noValidate:!0,onSubmit:c,children:C(y,{container:!0,spacing:3,children:[e(y,{item:!0,xs:12,md:12,children:C(O,{spacing:1,children:[e(W,{htmlFor:"question-form",children:"Pregunta*"}),e(H,{id:"question",type:"text",value:m.question,name:"question",onBlur:h,onChange:l,placeholder:"Pregunta...",fullWidth:!0,error:Boolean(u.question&&n.question)}),u.question&&n.question&&e(G,{error:!0,id:"helper-text-question-form",children:n.question})]})}),e(y,{item:!0,xs:12,md:12,children:e(Sn,{setFieldValue:g,savedCorretAnswer:r.opcion_correcta})}),e(y,{item:!0,xs:12,md:6,children:e(Ce,{questionData:r,setFilevideoPregunta:f,textToSay:m.question,setFieldValue:g})}),e(y,{item:!0,xs:12,md:6,children:C(O,{spacing:1,children:[e(W,{htmlFor:"avatarname-form",children:"Nombre de tu avatar"}),e(H,{id:"avatarname",type:"text",value:m.avatarname,name:"avatarname",onBlur:h,onChange:l,placeholder:"Nombre...",fullWidth:!0,error:Boolean(u.avatarname&&n.avatarname)}),u.avatarname&&n.avatarname&&e(G,{error:!0,id:"helper-text-avatarname-form",children:n.avatarname})]})}),n.submit&&e(y,{item:!0,xs:12,children:e(G,{error:!0,children:n.submit})}),e(y,{item:!0,xs:12,md:12,sx:{display:"flex",justifyContent:"flex-end"},children:e(ie,{type:"submit",disableElevation:!0,disabled:a,fullWidth:!0,size:"large",variant:"contained",color:"primary",loading:a,loadingPosition:"start",startIcon:e(Qe,{}),children:"Guardar"})})]})})})}const En=t=>t+"?v="+Date.now().toString();function Wn(){const{data:t,isLoading:a,hasError:s,postAWS:r}=B(),{data:f,isLoading:d,hasError:b,postAWS:n}=B(),{isLoading:h,postAWS:l}=B(),{isLoading:c,hasError:w,postUpload:u}=Za(),{token:m,userData:g}=i.useContext(J),{openAlert:x}=i.useContext(Y);let{pregunta_id:S,assessment_id:L}=xe();const[A,I]=i.useState(null),[F,P]=i.useState(null),[_,v]=i.useState(null),k=a||c||h||d,U=async()=>{const q=await r("https://aivx2bpza7.execute-api.us-east-1.amazonaws.com/prod/assessments","get_question",{id:S},m);if(!q){x("Lo sentimos, ha ocurrido un error al intentar obtener los datos de la pregunta","error");return}if(!q.success){x(`${q.message}: ${q.error}`,"error"),I({error:"Lo sentimos, no se ha podido acceder a la información de esta pregunta"});return}const R=q.data;I(R),P(R.video_avatar_pregunta)},X=async q=>{const R={...q,id:S},z=await n("https://aivx2bpza7.execute-api.us-east-1.amazonaws.com/prod/assessments","update_question",R,m);if(!z){x("Lo sentimos, ha ocurrido un error al intentar actualizar los datos","error");return}z.success?(x(z.message,"success"),I(Q=>({...Q,data:q}))):x(`${z.message}: ${z.error}`,"error")},ee=async()=>{if(!_&&!(_ instanceof File))return F;const q=await l("https://aivx2bpza7.execute-api.us-east-1.amazonaws.com/prod/assessments","get_url_upload_question_video",{id_pregunta:S,id_assessment:L,id_usuario_administrador:g.id,tamano_archivo:_.size},m);if(!q){x("Lo sentimos, ha ocurrido un error al subir el video de la pregunta.","error");return}if(q.success){const{url_subida:R,url_lectura:z}=q.data;return R&&z?await u(R,"video/mp4",_)?(P(En(z)),z):(x("Ha ocurrido un error al subir el video de la pregunta. recuerda que sólo se admiten videos en formato mp4.","error"),null):null}else return x(q.error,"error"),null},j=async q=>{let R=null;if(_&&(R=await ee(),!R))return;const z={...q,video_avatar_pregunta:R};X(z)};if(i.useEffect(()=>{U()},[]),a||!A)return C(se,{title:"Cargando datos de la pregunta...",returnButton:!0,children:[e(ua,{}),e(D,{sx:{width:"100%",textAlign:"left",fontWeight:"medium"},children:"Cargando..."})]});const te=q=>{let R=e(Ne,{});switch(q){case"PARV":R=e(bn,{isLoadingSubmit:k,getIsLoading:a,questionData:A,setFilevideoPregunta:v,onSubmit:j});break;case"POUR":R=e(Cn,{isLoadingSubmit:k,getIsLoading:a,questionData:A,setFilevideoPregunta:v,onSubmit:j});break;default:R=e(Ee,{severity:"info",children:"Lo sentimos, el tipo de pregunta configurado no está disponible"})}return R};return e(se,{title:"Configuración: "+A.descripcion_tipo_de_pregunta,returnButton:!0,children:A.error?e(Ee,{severity:"info",children:A.error}):te(A.nombre_tipo_de_pregunta)})}export{Wn as default};
