import{r as n,C as R,A as y,u as C,a as x,j as e,as as w,I as S,b as D,p as B,M,S as E,O as W,F as $,at as q,T as v,au as N}from"./index-5c44cf89.js";import{S as J,L as U,f as V}from"./Search-7b655563.js";import{D as G}from"./Dot-d0b66850.js";import{A as H}from"./ActionDelete-f7563e5d.js";import{E as K}from"./EyeOutlined-82726049.js";import{D as Q}from"./DeleteOutlined-75a90ccf.js";import{P as X}from"./PlusOutlined-5a5bb3ba.js";import"./visuallyHidden-14c3de6e.js";import"./Select-292d2541.js";import"./OutlinedInput-acc43fe5.js";import"./FormControl-de68b7ca.js";import"./InputAdornment-6fc71513.js";import"./LoadingButton-35a5f9c8.js";const Y=({idAssessment:r,nombreAssessment:o,onFinish:s,urlDelete:g,actionDelete:h,dataDelete:l})=>{const{openAlert:c}=n.useContext(R),{token:b}=n.useContext(y),{data:d,isLoading:A,hasError:P,postAWS:_}=C(),m=()=>{c("Por favor confirma que deseas eliminar el assessment: "+o,"warning",e(H,{callback:p}))},p=async()=>{const i=await _(g,h,l,b);i.success?c(i.message,"success"):c(`${i.message}: ${i.error}`,"error"),s()};return x("div",{style:{display:"flex",justifyContent:"flex-end"},children:[e(w,{title:"Ver más detalles",children:e(S,{"aria-label":"delete",color:"primary",component:D,to:r,children:e(K,{})})}),e(w,{title:"Eliminar assessment",children:e(S,{"aria-label":"delete",color:"error",onClick:m,children:e(Q,{})})})]})},L=({numero_cargos:r})=>{let o="error",s="Sin usarse";return r>0&&(o="success",s=`Activo en ${r} cargos`),x(E,{direction:"row",spacing:1,alignItems:"center",justifyContent:"flex-end",children:[e(v,{children:s}),e(G,{color:o})]})};L.propTypes={status:B.number};function Z(r,o,s,g,h,l){return{name:o,role:s,status:L({numero_cargos:g}),creationDate:V(h),actions:e(Y,{idAssessment:r,nombreAssessment:o,onFinish:l,urlDelete:"https://aivx2bpza7.execute-api.us-east-1.amazonaws.com/prod/assessments",actionDelete:"delete_assessment",dataDelete:{id:r}})}}const ee=[{id:"name",numeric:!1,disablePadding:!0,label:"Nombre del assessment",sortable:!0,align:"left"},{id:"role",numeric:!1,disablePadding:!1,label:"Rol",sortable:!0,align:"right"},{id:"status",numeric:!1,disablePadding:!1,label:"Estado",sortable:!0,align:"right"},{id:"creationDate",numeric:!1,disablePadding:!1,label:"Fecha de creación",sortable:!0,align:"right"},{id:"actions",numeric:!1,disablePadding:!1,label:"Acciones",sortable:!1,align:"right"}],pe=()=>{const{token:r,userData:o}=n.useContext(y),{data:s,isLoading:g,hasError:h,postAWS:l}=C(),[c,b]=n.useState([]),[d,A]=n.useState(""),[P,_]=n.useState("No se han encontrado registros"),[m,p]=n.useState(1),[i,I]=n.useState(5),[T,k]=n.useState(0),z=(a,t)=>{p(t+1),f(t+1)},j=a=>{const t=parseInt(a.target.value,10);I(t),p(1),f(1,t)},f=async(a=null,t)=>{if(d.trim()!==""){await F(d,a||m,t||i);return}await l("https://aivx2bpza7.execute-api.us-east-1.amazonaws.com/prod/assessments","get_all_assessments",{id_usuario_administrador:o.id,cantidad_por_pagina:t||i,pagina:a||m},r)},F=async(a,t=null,u)=>{await l("https://aivx2bpza7.execute-api.us-east-1.amazonaws.com/prod/assessments","search_by_name_assessments",{id_usuario_administrador:o.id,nombre_buscado:a,cantidad_por_pagina:u||i,pagina:t||m},r)};return n.useEffect(()=>{d.trim()!==""?(p(1),f(1,i)):f()},[d]),n.useEffect(()=>{if(s)if(s.success){if(s.data&&s.data.assessments){const a=s.data.assessments;if(a.length>0){let t=[];a.forEach(u=>{const O=Z(u.id,u.nombre,"Creador",u.numero_de_cargos,u.fecha_de_registro,f);t=[...t,O]}),b(t),k(s.data.elementos_totales)}else b([]),_(s.message)}}else s.message&&_(s.message)},[s]),e(M,{title:"Assessments",secondary:x(E,{direction:"row",spacing:2,children:[e(J,{searchString:d,setSearchString:A}),e(W,{variant:"outlined",startIcon:e(X,{}),component:D,to:"nuevo",children:"Crear assessment"})]}),children:g?x($,{children:[e(q,{}),e(v,{sx:{width:"100%",textAlign:"left",fontWeight:"medium"},children:"Cargando..."})]}):c.length>0?e(U,{rows:c,headCells:ee,controllerPage:m,controllerRowsPerPage:i,changePage:z,changeRowsPerPage:j,totalElements:T}):e(N,{severity:"info",children:P})})};export{pe as default};
